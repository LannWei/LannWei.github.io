import{r as a,o as t,b as e,w as o,H as l,K as s,N as i,J as r,Q as n,k as u,_ as c,F as v,X as d,Z as p,I as h,O as y,n as m}from"./vendor-BlYIN2Q_.js";import{S as f}from"./SectionTitle-DGgJ2_38.js";import{_ as g,d as x}from"./index-B9tmYGsa.js";import{f as b}from"./naive-ui-CdBP3e5b.js";/* empty css                                                                     */const I={class:"section-block group-photo-section"},k={key:0,class:"section-description text-primary"},w=["innerHTML"],M={class:"content-wrap"},P={key:0,class:"photo-gallery"},A={key:0,class:"photo-text text-secondary"},G={class:"photo-wrapper card-base card-hover-lift"},_={class:"photo-info text-muted"},j={key:0,class:"photo-meta"},H={key:0},S={key:1},Z={key:1,class:"album-section"},L={class:"album-title title-primary text-accent"},W=["onClick"],C=["alt"],D={key:1,class:"history-section"},Q={class:"history-gallery"},R=["onClick"],T=["alt"],Y={class:"history-photo-year"},B="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiIGZvbnQtc2l6ZT0iMTgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNjY2MiPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+",z=g({__name:"GroupPhoto",setup(g){const z=a(null),E=a([]),J=a({}),N=a([]),F=a(""),U=a(""),O=a("Group Photo"),V=a(""),$=a(!1),K=a(""),X=a(""),q=a(""),aa=a(""),ta=a(null);function ea(a){return"string"==typeof a?{url:a}:a}function oa(){sa()}function la(){sa()}function sa(){const a=ta.value;if(!a)return;const t=Array.from(a.children);if(!t.length)return;const e=a.clientWidth;let o=Math.max(1,Math.floor((e+14)/264));992>e||(o=Math.max(o,3));const l=Math.floor((e-14*(o-1))/o),s=Array(o).fill(0);a.style.position="relative",t.forEach(a=>{a.style.position="absolute",a.style.width=l+"px";const t=s.indexOf(Math.min(...s)),e=t*(l+14),o=s[t];a.style.transform=`translate(${e}px, ${o}px)`,a.style.top="0",a.style.left="0",s[t]+=a.offsetHeight+14});const i=Math.max(...s)-14;a.style.height=(i>0?i:0)+"px"}return t(()=>{!async function(){var a,t,e,o,l,s;const i=await x.getData("/data/group-photo-content.json");i.metadata&&(O.value=i.metadata.title||"Group Photo",V.value=i.metadata.description||""),U.value=i.description||"";const r=(i.history||[]).filter(a=>a.url||a.photos.length>0),n=r.length?Math.max(...r.map(a=>parseInt(a.year,10)||0))+"":"";F.value=n||(new Date).getFullYear().toString(),E.value=r;const u={};Array.isArray(i.albums)&&i.albums.forEach(a=>{u[a.year]={cover:a.url||a.cover||"",date:a.date,location:a.location,photos:a.photos||[]}}),r.forEach(a=>{u[a.year]||(u[a.year]={cover:a.url,date:a.date,location:a.location,photos:a.photos||[]})});const c=i.currentYearPhotos||i.currentPhotos||(null==(a=i.main)?void 0:a.photos)||[];if(c&&c.length){u[F.value]=u[F.value]||{cover:null==(t=i.main)?void 0:t.url,date:null==(e=i.main)?void 0:e.date,location:null==(o=i.main)?void 0:o.location,photos:[]};const a=[...Array.isArray(u[F.value].photos)?u[F.value].photos:[],...c];u[F.value].photos=Array.from(new Set(a))}J.value=u;const v=r.find(a=>a.year===F.value);z.value={url:null==(l=u[F.value])?void 0:l.cover},X.value=(null==v?void 0:v.text)||"",q.value=(null==v?void 0:v.date)||"",aa.value=(null==v?void 0:v.location)||"",N.value=((null==(s=u[F.value])?void 0:s.photos)||[]).map(ea)}(),window.addEventListener("resize",la,{passive:!0})}),e(()=>{window.removeEventListener("resize",la)}),o(N,async()=>{await m(),sa()}),(a,t)=>{const e=c("lazyload");return h(),l("section",I,[s(f,{title:O.value},null,8,["title"]),V.value?(h(),l("div",k,[r("p",{innerHTML:V.value},null,8,w)])):i("",!0),r("div",M,[z.value&&z.value.url?(h(),l("div",P,[X.value?(h(),l("div",A,n(X.value),1)):i("",!0),r("div",G,[u((h(),l("img",{key:z.value.url,src:B,alt:"Group Photo",class:"group-photo"})),[[e,z.value.url]])]),r("div",_,[q.value||aa.value?(h(),l("div",j,[q.value?(h(),l("span",H,"Date： "+n(q.value),1)):i("",!0),aa.value?(h(),l("span",S,"Location： "+n(aa.value),1)):i("",!0)])):i("",!0)])])):i("",!0),N.value&&N.value.length>0?(h(),l("div",Z,[r("div",L,n(F.value)+" Album",1),r("div",{class:"masonry-wall",ref_key:"masonryWallRef",ref:ta},[(h(!0),l(v,null,d(N.value,(a,t)=>(h(),l("div",{key:a.url||a,class:"masonry-item card-base card-hover-lift",onClick:t=>function(a){const t=a.url||a;K.value=t,$.value=!0}(a)},[u(r("img",{src:B,alt:"Album photo "+(t+1),class:"masonry-img",onLoad:oa},null,40,C),[[e,a.url||a]])],8,W))),128))],512)])):i("",!0)]),s(p(b)),E.value.length?(h(),l("div",D,[t[0]||(t[0]=r("div",{class:"history-title title-primary text-accent"},"Group Photos by Year",-1)),r("div",Q,[(h(!0),l(v,null,d(E.value,a=>(h(),l("div",{key:a.year,class:"history-photo-wrapper card-base card-hover-lift",onClick:y(t=>function(a){var t;F.value=a.year,z.value={url:a.url},X.value=a.text||"",q.value=a.date||"",aa.value=a.location||"",N.value=((null==(t=J.value[a.year])?void 0:t.photos)||[]).map(ea),m(()=>{sa()})}(a),["stop"])},[u(r("img",{src:B,alt:"Group Photo "+a.year,class:"history-photo"},null,8,T),[[e,a.url||a.photos[0]]]),r("div",Y,n(a.year),1)],8,R))),128))])])):i("",!0)])}}},[["__scopeId","data-v-3cb38d17"]]);export{z as default};
